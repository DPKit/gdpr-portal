'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a},_createClass=function(){function a(b,d){for(var g,f=0;f<d.length;f++)g=d[f],g.enumerable=g.enumerable||!1,g.configurable=!0,'value'in g&&(g.writable=!0),Object.defineProperty(b,g.key,g)}return function(b,d,f){return d&&a(b.prototype,d),f&&a(b,f),b}}();function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,d=Array(a.length);b<a.length;b++)d[b]=a[b];return d}return Array.from(a)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function _inherits(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var _window$preact=window.preact,Component=_window$preact.Component,h=_window$preact.h,render=_window$preact.render,App=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),_createClass(b,[{key:'componentDidMount',value:function componentDidMount(){this.setState({message:'Hello!'})}},{key:'render',value:function(){return h('div',{id:'app'},h(Form))}}]),b}(Component);String.prototype.format=function(){'use strict';var a=this.toString(),b=_typeof(arguments[0]),d;d=0==arguments.length?{}:'string'===b||'number'===b?Array.prototype.slice.call(arguments):arguments[0];for(var j,f=[],g=a;0<g.length;)if(j=g.match(/\{(?!\{)([\w\d]+)\}(?!\})/),null!==j){var k=g.substr(0,j.index),l=g.substr(j.index,j[0].length);g=g.substr(j.index+j[0].length);var o=parseInt(j[1]);f.push(k),o==o?f.push(d[o]):f.push(d[j[1]])}else f.push(g),g='';return f};function t(a){var b=translations[window.language][a];if(b===void 0)return'[no translation available for key '+a+']';var d=b.format.apply(b,_toConsumableArray(Array.prototype.slice.call(arguments,1)));return d}var Form=function(a){function b(){var u,k,l,o;_classCallCheck(this,b);for(var q=arguments.length,j=Array(q),r=0;r<q;r++)j[r]=arguments[r];return o=(k=(l=_possibleConstructorReturn(this,(u=b.__proto__||Object.getPrototypeOf(b)).call.apply(u,[this].concat(j))),l),l.state={submitting:!1,status:'pending',data:{},errors:{}},k),_possibleConstructorReturn(l,o)}return _inherits(b,a),_createClass(b,[{key:'encodeData',value:function encodeData(j){var k=[];for(var l in j)k.push(encodeURIComponent(l)+'='+encodeURIComponent(j[l]));return k.join('&')}},{key:'submitData',value:function submitData(j){var k=new XMLHttpRequest,l=this.encodeData(j);$.ajax({type:'POST',url:'https://auth.dpkit.com/api/newsletter/v1/subscribe/beta',crossDomain:!0,data:l}).done(function(){this.setState({status:'success'})}.bind(this)).fail(function(o){var q=o.responseJSON;if(void 0!==q&&void 0!==q.errors){var r={},u=q.errors;for(var v in u)r[v]=u[v]in translations?translations[u[v]]:u[v];this.setState({status:'pending',errors:r})}else this.setState({status:'failed'})}.bind(this))}},{key:'onSubmit',value:function onSubmit(j){var k=this.state;j.preventDefault();var l=this.validate(k.data);return 0<Object.keys(l).length?void this.setState({errors:l}):void(this.setState({status:'sending',errors:{}}),this.submitData(k.data))}},{key:'validate',value:function validate(j){var k={},l=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/i;j.email||(k.email=t('email-missing')),l.test(j.email)||(k.email=t('email-invalid'));var o=/^.{3,50}$/i;j.company||(k.company=t('company-name-missing')),o.test(j.company)||(k.company=t('company-name-invalid'));var q=/^.{3,50}$/i;j.name||(k.name=t('contact-name-invalid')),q.test(j.name)||(k.name=t('contact-name-invalid'));var r=/^[0-9\-\/\+]{3,50}$/i;return j.phone&&!r.test(j.phone)&&(k.phone=t('phone-number-invalid')),k}},{key:'setValue',value:function setValue(j,k){var l=this.state.data;l[j]=k.target.value,this.setState({data:l})}},{key:'renderSuccess',value:function renderSuccess(){return h('div',null,h('h2',null,t('thanks')),h('p',{'class':'alert alert-success'},t('data-has-been-saved')))}},{key:'render',value:function(){return'success'==this.state.status?this.renderSuccess():this.renderForm()}},{key:'renderForm',value:function renderForm(){var r,u=this,k=this.state,l=k.data,o=k.errors,q=this.state.status;function j(v){return o[v]?h('p',{'class':'alert alert-warning'},o[v]):null}return'failed'==q&&(r=h('p',{'class':'alert alert-warning'},t('something-went-wrong',{email:h('a',{href:'mailto:'+t('signup-email')},t('signup-email'))}))),h('form',{ref:function ref(v){return u.form=v},id:'signup',onSubmit:this.onSubmit.bind(this)},r,h('fieldset',{disabled:'sending'===q},h('div',{'class':'form-group row'},h('label',{'for':'email','class':'col-md-4 col-lg-3 col-form-label'},t('email')),h('div',{'class':'col-md-8 col-lg-9'},j('email'),h('input',{type:'email','class':'form-control',id:'email',placeholder:t('email-placeholder'),onChange:this.setValue.bind(this,'email'),value:l.email||''}))),h('div',{'class':'form-group row'},h('label',{'for':'company','class':'col-md-4 col-lg-3 col-form-label'},t('company-name')),h('div',{'class':'col-md-8 col-lg-9'},j('company'),h('input',{type:'text','class':'form-control',id:'company',placeholder:t('company-placeholder'),onChange:this.setValue.bind(this,'company'),value:l.company||''}))),h('div',{'class':'form-group row'},h('label',{'for':'name','class':'col-md-4 col-lg-3 col-form-label'},t('contact-name')),h('div',{'class':'col-md-8 col-lg-9'},j('name'),h('input',{type:'text','class':'form-control',id:'name',placeholder:t('name-placeholder'),onChange:this.setValue.bind(this,'name'),value:l.name||''}))),h('div',{'class':'form-group row'},h('label',{'for':'phone','class':'col-md-4 col-lg-3 col-form-label'},t('phone')),h('div',{'class':'col-md-8 col-lg-9'},j('phone'),h('input',{type:'phone','class':'form-control',id:'phone',placeholder:t('phone-placeholder'),onChange:this.setValue.bind(this,'phone'),value:l.phone||''}))),h('div',{'class':'form-group row'},h('label',{'class':'d-xs-none col-md-4 col-lg-3 col-form-label'}),h('div',{'class':'col-md-8 col-lg-9'},h('button',{type:'submit','class':'btn btn-green btn-intro btn-md'},'sending'==q?t('please-wait'):t('submit'))))))}}]),b}(Component);$(document).ready(function(){var a=document.getElementById('signup-wrapper');a.innerHTML='',render(h(App),a)});