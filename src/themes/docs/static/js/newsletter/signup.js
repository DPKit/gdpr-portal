'use strict';var _createClass=function(){function a(b,d){for(var g,f=0;f<d.length;f++)g=d[f],g.enumerable=g.enumerable||!1,g.configurable=!0,'value'in g&&(g.writable=!0),Object.defineProperty(b,g.key,g)}return function(b,d,f){return d&&a(b.prototype,d),f&&a(b,f),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function _inherits(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var _window$preact=window.preact,Component=_window$preact.Component,h=_window$preact.h,render=_window$preact.render,App=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),_createClass(b,[{key:'componentDidMount',value:function componentDidMount(){this.setState({message:'Hello!'})}},{key:'render',value:function(){return h('div',{id:'app'},h(Form))}}]),b}(Component),translations={'Invalid email address.':'Bitte geben Sie eine g\xFCltige E-Mail Adresse an.'},Form=function(a){function b(){var q,k,l,m;_classCallCheck(this,b);for(var n=arguments.length,j=Array(n),o=0;o<n;o++)j[o]=arguments[o];return m=(k=(l=_possibleConstructorReturn(this,(q=b.__proto__||Object.getPrototypeOf(b)).call.apply(q,[this].concat(j))),l),l.state={submitting:!1,status:'pending',data:{},errors:{}},k),_possibleConstructorReturn(l,m)}return _inherits(b,a),_createClass(b,[{key:'encodeData',value:function encodeData(j){var k=[];for(var l in j)k.push(encodeURIComponent(l)+'='+encodeURIComponent(j[l]));return k.join('&')}},{key:'submitData',value:function submitData(j){var k=new XMLHttpRequest,l=this.encodeData(j);$.ajax({type:'POST',url:'https://auth.kiprotect.com/api/newsletter/v1/subscribe/newsletter',crossDomain:!0,data:l}).done(function(){this.setState({status:'success'})}.bind(this)).fail(function(m){var n=m.responseJSON;if(void 0!==n&&void 0!==n.errors){var o={},q=n.errors;for(var r in q)o[r]=q[r]in translations?translations[q[r]]:q[r];this.setState({status:'pending',errors:o})}else this.setState({status:'failed'})}.bind(this))}},{key:'onSubmit',value:function onSubmit(j){var k=this.state;j.preventDefault();var l=this.validate(k.data);return 0<Object.keys(l).length?void this.setState({errors:l}):void(this.setState({status:'sending',errors:{}}),this.submitData(k.data))}},{key:'validate',value:function validate(j){var k={},l=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/i;if(j.email||(k.email='Bitte geben Sie eine E-Mail Adresse an.'),l.test(j.email)||(k.email='Bitte geben Sie eine g\xFCltige E-Mail Adresse an.'),j.name){var m=/^.{3,50}$/i;m.test(j.name)||(k.name='Bitte geben Sie einen g\xFCltigen Namen an (mindestens drei Zeichen, maximal 50).')}return k}},{key:'setValue',value:function setValue(j,k){var l=this.state.data;l[j]=k.target.value,this.setState({data:l})}},{key:'renderSuccess',value:function renderSuccess(){return h('div',null,h('h2',null,'Vielen Dank!'),h('p',{'class':'alert alert-success'},'Ihre Angaben wurden erfolgreich gespeichert.'))}},{key:'render',value:function(){return'success'==this.state.status?this.renderSuccess():this.renderForm()}},{key:'renderForm',value:function renderForm(){var o,q=this,k=this.state,l=k.data,m=k.errors,n=this.state.status;function j(r){return m[r]?h('p',{'class':'alert alert-warning'},m[r]):null}return'failed'==n&&(o=h('p',{'class':'alert alert-warning'},'Beim Versenden Ihrer Daten ist leider etwas schiefgegangen. Sie k\xF6nnen uns alternativ auch eine E-Mail an ',h('a',{href:'mailto:newsletter@kiprotect.com'},'newsletter@kiprotect.com'),' schicken. Wir bitten die Unannehmlichkeiten zu entschuldigen.')),h('form',{ref:function ref(r){return q.form=r},id:'signup',onSubmit:this.onSubmit.bind(this)},o,h('fieldset',{disabled:'sending'===n},h('div',{'class':'form-group row'},h('label',{'for':'email','class':'col-md-4 col-lg-3 col-form-label'},'Email'),h('div',{'class':'col-md-8 col-lg-9'},j('email'),h('input',{type:'email','class':'form-control',id:'email',placeholder:'david.duesentrieb@muster-ag.de',onChange:this.setValue.bind(this,'email'),value:l.email||''}))),h('div',{'class':'form-group row'},h('label',{'for':'name','class':'col-md-4 col-lg-3 col-form-label'},'Name (optional)'),h('div',{'class':'col-md-8 col-lg-9'},j('name'),h('input',{type:'text','class':'form-control',id:'name',placeholder:'David D\xFCsentrieb',onChange:this.setValue.bind(this,'name'),value:l.name||''}))),h('div',{'class':'form-group row'},h('label',{'class':'d-xs-none col-md-4 col-lg-3 col-form-label'}),h('div',{'class':'col-md-8 col-lg-9'},h('button',{type:'submit','class':'btn btn-green btn-intro btn-lg'},'sending'==n?'Bitte warten...':'Anmelden')))))}}]),b}(Component);$(document).ready(function(){var a=document.getElementById('signup-wrapper');a.innerHTML='',render(h(App),a)});